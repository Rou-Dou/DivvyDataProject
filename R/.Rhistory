gc()
gc()
#################### Import Libraries ###################
library(ggmap)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(lubridate)
library(maps)
library(ggthemes)
library(ggrepel)
library(rstudioapi)
library(data.table)
library(broom)
library(gridExtra)
########################### Functions #####################################
# create function to find mode
getmode <- function(x){
u <- unique(x)
t <- tabulate(match(x, u))
return(u[t == max(t)])
}
createDonut <- function (x, filter_text){
x %>%
filter(member_type == filter_text) -> x_prime
x_prime$fraction <- x_prime$ride_count/
sum(x_prime$ride_count)
x_prime$ymax <- cumsum(x_prime$fraction)
x_prime$ymin <- c(0, head(x_prime$ymax, n=-1))
x_prime$labelPosition <- (x_prime$ymax + x_prime$ymin)/2
x_prime$season <- c('Winter', 'Spring', 'Summer', 'Fall')
return(x_prime)
}
trip_totals <- function (table_in, filter_name){
## Create Top_ten_trips table including both counts and lat/lon
## coordinates
table_in %>%
filter(member_type == filter_name) -> a
merge(x = a, y = r_station_pairs,
by = 'pair_id') %>%
arrange(desc(trip_count)) %>%
subset(select = c('start_station_id', 'end_station_id', 'trip_count')) %>%
head(10) -> b
##Add coordinate information to top_ten_stations using r_station_lat_lng
merge(x = r_station_lat_lng, y = b,
by.x = 'station_id', by.y = 'start_station_id') %>%
merge(y = r_station_lat_lng, by.x = 'end_station_id',
by.y = 'station_id') -> b
b <- setcolorder(b, c(2,3,4,1,6,7,5))
return(b)
}
############ Data Import ############
r_station_lat_lng <- read.csv(
"cyclistic_r_station_lat_lon.csv",
header = FALSE)
d_ride_table <- read.csv(
"cyclistic_d_ride_table.csv",
header = FALSE)
r_station_table <- read.csv(
"cyclistic_r_station_table.csv",
header = FALSE)
setDT(d_ride_table)
list.files('\R', pattern = 'ride')
list.files('\\R', pattern = 'ride')
list.files('/R', pattern = 'ride')
list.files('/R', pattern = 'd_ride')
list.files(pattern = 'd_ride')
list.files(pattern = 'd_ride') %>%
map_df(~fread(header = FALSE, .)) -> d_ride_table
rm(d_ride_table)
list.files(pattern = 'd_ride') %>%
map_df(~fread(header = FALSE, .)) -> d_ride_table
View(d_ride_table)
rm(d_ride_table)
d_ride_table <- read.csv(
"cyclistic_d_ride_table.csv",
header = FALSE)
View(d_ride_table)
setDT(d_ride_table)
rm(d_ride_table)
list.files(pattern = 'd_ride')
list.files(pattern = 'd_ride') %>%
map_df(~fread(header = FALSE, .)) -> d_ride_table
View(d_ride_table)
gc()
list.files(pattern = 'd_ride') %>%
map_df(~fread(header = FALSE, .)) -> d_ride_table
View(d_ride_table)
gc()
